{
  "language": "php",
  "sudo": false,
  "cache": {
    "directories": [
      "node_modules",
      "$HOME/.composer/cache",
      "vendor",
    ]
  },
  "services": [
    "mysql",
    "memcached",
    "redis-server"
  ],
  "before_install": [
    "phpenv config-rm xdebug.ini || true",
    "echo \"extension = memcached.so\" >> ~/.phpenv/versions/$(phpenv version-name)/etc/php.ini",
    "printf \"\\n\" | pecl install -f redis",
    "npm update && npm run production",
    "mysql -e 'CREATE DATABASE webshelf;'",
    "composer update
    "travis_retry composer self-update",
    "php artisan migrate"
  ],
  "install": [
    "if [[ $setup = 'stable' ]]; then travis_retry composer update --prefer-dist --no-interaction --prefer-stable --no-suggest; fi",
    "if [[ $setup = 'lowest' ]]; then travis_retry composer update --prefer-dist --no-interaction --prefer-lowest --prefer-stable --no-suggest; fi"
  ],
  "script": "vendor/bin/phpunit",
  "global_env": "setup=stable",
  "group": "stable",
  "dist": "trusty",
  "php": 7.1,
  "os": "linux"
}
